<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tra Cứu Hồ Sơ - Cổng Dịch Vụ Công Quốc Gia</title>
    <meta name="description" content="Tra cứu tình trạng xử lý hồ sơ thủ tục hành chính">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%230F172A'/><polygon points='50,15 61,40 88,40 67,58 76,85 50,68 24,85 33,58 12,40 39,40' fill='%23B8860B'/></svg>">
    
    <!-- Google Fonts - Swiss Modernism -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;500;600;700&family=IBM+Plex+Sans:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        heading: ['EB Garamond', 'serif'],
                        body: ['IBM Plex Sans', 'sans-serif'],
                    },
                    colors: {
                        navy: '#0F172A',
                        navyLight: '#1E293B',
                        vietred: '#B91C1C',
                        vietredLight: '#DC2626',
                        gold: '#B8860B',
                        goldLight: '#D4A017',
                        accent: '#0369A1',
                        accentLight: '#0284C7',
                        cream: '#FEFDF8',
                        warmgray: '#F8F6F1',
                        border: '#E5E2D9',
                        text: '#1E293B',
                        muted: '#64748B',
                        success: '#166534',
                        successLight: '#22C55E',
                        warning: '#D97706',
                        warningLight: '#F59E0B',
                    },
                    boxShadow: {
                        'formal': '0 1px 3px rgba(15, 23, 42, 0.12), 0 1px 2px rgba(15, 23, 42, 0.08)',
                        'formal-md': '0 4px 6px rgba(15, 23, 42, 0.1), 0 2px 4px rgba(15, 23, 42, 0.06)',
                        'formal-lg': '0 10px 15px rgba(15, 23, 42, 0.1), 0 4px 6px rgba(15, 23, 42, 0.05)',
                    }
                }
            }
        }
    </script>
    <style>
        .formal-button {
            transition: all 0.2s ease;
        }
        .formal-button:hover {
            transform: translateY(-1px);
        }
        .timeline-line::before {
            content: '';
            position: absolute;
            left: 1.25rem;
            top: 3rem;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #0369A1, #E5E2D9);
        }
        .timeline-line:last-child::before {
            display: none;
        }
    </style>
</head>
<body class="font-body bg-cream text-text antialiased">
    
    <!-- Top Banner -->
    <div class="bg-navy text-white py-2 px-4 text-center text-sm">
        <span class="font-medium">CỔNG DỊCH VỤ CÔNG QUỐC GIA - NƯỚC CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</span>
    </div>

    <!-- Navigation -->
    <nav class="bg-white border-b-2 border-gold sticky top-0 z-50 shadow-formal">
        <div class="max-w-7xl mx-auto px-4 sm:px-6">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <a href="/" class="flex items-center gap-3 cursor-pointer">
                    <div class="w-11 h-11 bg-navy rounded flex items-center justify-center">
                        <svg class="w-6 h-6 text-gold" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                        </svg>
                    </div>
                    <div class="hidden sm:block">
                        <span class="font-heading font-bold text-lg text-navy tracking-tight">Dịch Vụ Công</span>
                        <span class="block text-xs text-muted font-medium tracking-widest uppercase">Việt Nam</span>
                    </div>
                </a>
                
                <!-- Desktop Nav -->
                <div class="hidden md:flex items-center gap-8">
                    <a href="/" class="text-navy hover:text-vietred transition-colors font-medium text-sm tracking-wide">Trang chủ</a>
                    <a href="/#services" class="text-navy hover:text-vietred transition-colors font-medium text-sm tracking-wide">Dịch vụ</a>
                    <a href="/election.html" class="text-navy hover:text-vietred transition-colors font-medium text-sm tracking-wide">Bầu cử</a>
                    <a href="/tracking.html" class="text-vietred font-semibold text-sm tracking-wide">Tra cứu</a>
                    <a href="/#contact" class="text-navy hover:text-vietred transition-colors font-medium text-sm tracking-wide">Liên hệ</a>
                </div>
                
                <!-- Hotline -->
                <div class="flex items-center gap-4">
                    <a href="tel:1900.9095" class="hidden sm:flex items-center gap-2 text-vietred font-semibold">
                        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                        </svg>
                        <span>1900.9095</span>
                    </a>
                    <button class="md:hidden p-2 text-navy" onclick="toggleMobileMenu()">
                        <svg class="w-6 h-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="3" y1="12" x2="21" y2="12"/>
                            <line x1="3" y1="6" x2="21" y2="6"/>
                            <line x1="3" y1="18" x2="21" y2="18"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-border">
            <div class="px-4 py-3 space-y-2">
                <a href="/" class="block py-2 text-navy font-medium">Trang chủ</a>
                <a href="/#services" class="block py-2 text-navy font-medium">Dịch vụ</a>
                <a href="/election.html" class="block py-2 text-navy font-medium">Bầu cử</a>
                <a href="/tracking.html" class="block py-2 text-vietred font-semibold">Tra cứu</a>
                <a href="/#contact" class="block py-2 text-navy font-medium">Liên hệ</a>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="bg-gradient-to-br from-navy to-navyLight text-white py-16 px-4">
        <div class="max-w-4xl mx-auto text-center">
            <div class="w-20 h-20 bg-gold/20 rounded-xl flex items-center justify-center mx-auto mb-6">
                <svg class="w-10 h-10 text-gold" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"/>
                    <path d="M21 21l-4.35-4.35"/>
                </svg>
            </div>
            <h1 class="font-heading text-3xl sm:text-4xl lg:text-5xl font-bold mb-4">
                Tra Cứu Hồ Sơ
            </h1>
            <p class="text-white/80 text-lg max-w-2xl mx-auto">
                Kiểm tra tình trạng xử lý hồ sơ thủ tục hành chính của bạn một cách nhanh chóng và chính xác.
            </p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="py-12 px-4 sm:px-6">
        <div class="max-w-4xl mx-auto">
            
            <!-- Search Form -->
            <div class="bg-white border border-border rounded-lg shadow-formal-lg p-6 sm:p-8 -mt-12 relative z-10 mb-12">
                <form id="tracking-form" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-navy mb-2">Mã hồ sơ / Mã biên nhận</label>
                        <div class="relative">
                            <input type="text" id="tracking-code" name="code" required placeholder="Nhập mã hồ sơ (VD: HS2026123456, LH12345678)" class="w-full pl-12 pr-4 py-4 border border-border rounded-lg focus:ring-2 focus:ring-accent/20 focus:border-accent text-lg transition-colors">
                            <svg class="w-5 h-5 text-muted absolute left-4 top-1/2 -translate-y-1/2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                <polyline points="14,2 14,8 20,8"/>
                            </svg>
                        </div>
                        <p class="text-sm text-muted mt-2">Mã hồ sơ được cấp khi bạn nộp hồ sơ tại cơ quan hành chính hoặc trực tuyến.</p>
                    </div>
                    
                    <button type="submit" id="search-btn" class="formal-button w-full bg-navy hover:bg-navyLight text-white font-semibold py-4 rounded-lg shadow-formal-md flex items-center justify-center gap-3 transition-colors">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="M21 21l-4.35-4.35"/>
                        </svg>
                        <span>Tra Cứu Ngay</span>
                    </button>
                </form>
            </div>

            <!-- Loading State -->
            <div id="loading-state" class="hidden text-center py-12">
                <div class="animate-spin w-12 h-12 border-4 border-accent border-t-transparent rounded-full mx-auto mb-4"></div>
                <p class="text-muted">Đang tra cứu hồ sơ...</p>
            </div>

            <!-- Result Section -->
            <div id="result-section" class="hidden">
                
                <!-- Result Header -->
                <div class="bg-white border border-border rounded-lg shadow-formal-md overflow-hidden mb-6">
                    <div class="bg-navy px-6 py-4">
                        <div class="flex items-center justify-between flex-wrap gap-4">
                            <div>
                                <span class="text-white/70 text-sm block">Mã hồ sơ</span>
                                <span id="result-code" class="text-gold font-heading text-2xl font-bold"></span>
                            </div>
                            <div id="result-status-badge"></div>
                        </div>
                    </div>
                    <div class="p-6">
                        <h2 id="result-service-name" class="font-heading text-xl font-bold text-navy mb-4"></h2>
                        
                        <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4">
                            <div class="p-4 bg-warmgray rounded-lg">
                                <span class="text-xs text-muted uppercase tracking-wide block mb-1">Người nộp</span>
                                <span id="result-applicant" class="font-semibold text-navy"></span>
                            </div>
                            <div class="p-4 bg-warmgray rounded-lg">
                                <span class="text-xs text-muted uppercase tracking-wide block mb-1">Ngày nộp</span>
                                <span id="result-submit-date" class="font-semibold text-navy"></span>
                            </div>
                            <div class="p-4 bg-warmgray rounded-lg">
                                <span class="text-xs text-muted uppercase tracking-wide block mb-1">Dự kiến hoàn thành</span>
                                <span id="result-estimated" class="font-semibold text-navy"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Progress Timeline -->
                <div class="bg-white border border-border rounded-lg shadow-formal-md overflow-hidden mb-6">
                    <div class="bg-accent px-6 py-4">
                        <h3 class="font-heading text-lg font-bold text-white flex items-center gap-2">
                            <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="9,11 12,14 22,4"/>
                                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"/>
                            </svg>
                            Tiến Độ Xử Lý
                        </h3>
                    </div>
                    <div class="p-6">
                        <div id="result-timeline" class="space-y-0">
                            <!-- Dynamic content -->
                        </div>
                    </div>
                </div>

                <!-- Additional Info -->
                <div class="grid sm:grid-cols-2 gap-6">
                    <div class="bg-white border border-border rounded-lg shadow-formal p-6">
                        <h4 class="font-heading text-lg font-bold text-navy mb-4 flex items-center gap-2">
                            <svg class="w-5 h-5 text-accent" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M3 21h18"/>
                                <path d="M5 21V7l8-4v18"/>
                                <path d="M19 21V11l-6-4"/>
                            </svg>
                            Cơ quan xử lý
                        </h4>
                        <p id="result-agency" class="text-muted"></p>
                    </div>
                    
                    <div class="bg-white border border-border rounded-lg shadow-formal p-6">
                        <h4 class="font-heading text-lg font-bold text-navy mb-4 flex items-center gap-2">
                            <svg class="w-5 h-5 text-gold" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="1" x2="12" y2="23"/>
                                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/>
                            </svg>
                            Lệ phí
                        </h4>
                        <p id="result-fee" class="text-muted"></p>
                    </div>
                </div>

                <!-- Actions -->
                <div class="mt-8 flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="printResult()" class="formal-button flex items-center justify-center gap-2 bg-navy hover:bg-navyLight text-white font-semibold px-6 py-3 rounded-lg transition-colors">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="6,9 6,2 18,2 18,9"/>
                            <path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"/>
                            <rect x="6" y="14" width="12" height="8"/>
                        </svg>
                        In kết quả
                    </button>
                    <button onclick="searchAnother()" class="formal-button flex items-center justify-center gap-2 border-2 border-navy text-navy hover:bg-navy hover:text-white font-semibold px-6 py-3 rounded-lg transition-colors">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="M21 21l-4.35-4.35"/>
                        </svg>
                        Tra cứu hồ sơ khác
                    </button>
                </div>
            </div>

            <!-- Error State -->
            <div id="error-state" class="hidden">
                <div class="bg-white border border-border rounded-lg shadow-formal-md p-8 text-center">
                    <div class="w-20 h-20 bg-vietred/10 rounded-full flex items-center justify-center mx-auto mb-6">
                        <svg class="w-10 h-10 text-vietred" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                            <circle cx="12" cy="12" r="10"/>
                            <path d="M12 8v4"/>
                            <path d="M12 16h.01"/>
                        </svg>
                    </div>
                    <h3 class="font-heading text-xl font-bold text-navy mb-2">Không tìm thấy hồ sơ</h3>
                    <p class="text-muted mb-6">Mã hồ sơ bạn nhập không tồn tại trong hệ thống. Vui lòng kiểm tra lại mã hồ sơ.</p>
                    <button onclick="searchAnother()" class="formal-button inline-flex items-center gap-2 bg-navy hover:bg-navyLight text-white font-semibold px-6 py-3 rounded-lg transition-colors">
                        <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 12H5M12 19l-7-7 7-7"/>
                        </svg>
                        Thử lại
                    </button>
                </div>
            </div>

            <!-- Demo Codes -->
            <div id="demo-codes" class="mt-12 bg-warmgray border border-border rounded-lg p-6">
                <h3 class="font-heading text-lg font-bold text-navy mb-4 flex items-center gap-2">
                    <svg class="w-5 h-5 text-accent" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 16v-4"/>
                        <path d="M12 8h.01"/>
                    </svg>
                    Mã hồ sơ mẫu để thử nghiệm
                </h3>
                <p class="text-sm text-muted mb-4">Bạn có thể sử dụng các mã sau để thử nghiệm tính năng tra cứu:</p>
                <div class="flex flex-wrap gap-3">
                    <button onclick="fillDemoCode('HS2026001234')" class="px-4 py-2 bg-white border border-border rounded-lg text-sm font-mono text-navy hover:border-accent hover:bg-accent/5 transition-colors">
                        HS2026001234
                    </button>
                    <button onclick="fillDemoCode('HS2026005678')" class="px-4 py-2 bg-white border border-border rounded-lg text-sm font-mono text-navy hover:border-accent hover:bg-accent/5 transition-colors">
                        HS2026005678
                    </button>
                    <button onclick="fillDemoCode('HS2026009012')" class="px-4 py-2 bg-white border border-border rounded-lg text-sm font-mono text-navy hover:border-accent hover:bg-accent/5 transition-colors">
                        HS2026009012
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Help Section -->
    <section class="bg-navy text-white py-16 px-4">
        <div class="max-w-4xl mx-auto">
            <h2 class="font-heading text-2xl font-bold text-center mb-8">Cần Hỗ Trợ?</h2>
            <div class="grid sm:grid-cols-3 gap-6">
                <a href="tel:1900.9095" class="bg-white/10 hover:bg-white/20 rounded-lg p-6 text-center transition-colors">
                    <div class="w-14 h-14 bg-gold/20 rounded-lg flex items-center justify-center mx-auto mb-4">
                        <svg class="w-7 h-7 text-gold" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                        </svg>
                    </div>
                    <h3 class="font-heading text-lg font-bold mb-2">Tổng đài</h3>
                    <p class="text-gold font-semibold text-lg">1900.9095</p>
                    <p class="text-white/60 text-sm mt-1">24/7</p>
                </a>
                
                <a href="mailto:hotro@dichvucong.gov.vn" class="bg-white/10 hover:bg-white/20 rounded-lg p-6 text-center transition-colors">
                    <div class="w-14 h-14 bg-gold/20 rounded-lg flex items-center justify-center mx-auto mb-4">
                        <svg class="w-7 h-7 text-gold" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                            <polyline points="22,6 12,13 2,6"/>
                        </svg>
                    </div>
                    <h3 class="font-heading text-lg font-bold mb-2">Email</h3>
                    <p class="text-white/80 text-sm">hotro@dichvucong.gov.vn</p>
                </a>
                
                <a href="/#contact" class="bg-white/10 hover:bg-white/20 rounded-lg p-6 text-center transition-colors">
                    <div class="w-14 h-14 bg-gold/20 rounded-lg flex items-center justify-center mx-auto mb-4">
                        <svg class="w-7 h-7 text-gold" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/>
                        </svg>
                    </div>
                    <h3 class="font-heading text-lg font-bold mb-2">Chat trực tuyến</h3>
                    <p class="text-white/80 text-sm">Hỗ trợ nhanh chóng</p>
                </a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-navyLight text-white py-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-4">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-white/10 rounded-lg flex items-center justify-center">
                        <svg class="w-5 h-5 text-gold" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                        </svg>
                    </div>
                    <span class="font-heading font-bold">Dịch Vụ Công Việt Nam</span>
                </div>
                <p class="text-white/50 text-sm text-center">
                    © 2026 Cổng Dịch Vụ Công Quốc Gia - Nước Cộng hòa Xã hội Chủ nghĩa Việt Nam
                </p>
            </div>
        </div>
    </footer>

    <script>
        const API_BASE = window.location.origin;

        // Demo data
        const demoData = {
            'HS2026001234': {
                code: 'HS2026001234',
                serviceName: 'Cấp Căn cước công dân gắn chip lần đầu',
                applicant: 'Nguyễn Văn An',
                phone: '0901234567',
                submitDate: '2026-01-15',
                estimatedDate: '2026-01-22',
                status: 'processing',
                fee: '25,000 VNĐ',
                agency: 'Công an Quận Ba Đình, TP. Hà Nội',
                timeline: [
                    { status: 'received', date: '2026-01-15 08:30', note: 'Hồ sơ đã được tiếp nhận', completed: true },
                    { status: 'verifying', date: '2026-01-15 14:00', note: 'Đang xác minh thông tin', completed: true },
                    { status: 'processing', date: '2026-01-17 09:00', note: 'Đang xử lý tại phòng QLHC', completed: true },
                    { status: 'approval', date: '', note: 'Chờ phê duyệt', completed: false },
                    { status: 'completed', date: '', note: 'Hoàn thành - Sẵn sàng trả kết quả', completed: false }
                ]
            },
            'HS2026005678': {
                code: 'HS2026005678',
                serviceName: 'Đăng ký kết hôn',
                applicant: 'Trần Minh Tuấn',
                phone: '0912345678',
                submitDate: '2026-01-10',
                estimatedDate: '2026-01-17',
                status: 'completed',
                fee: 'Miễn phí',
                agency: 'UBND Phường Láng Hạ, Quận Đống Đa, TP. Hà Nội',
                timeline: [
                    { status: 'received', date: '2026-01-10 09:00', note: 'Hồ sơ đã được tiếp nhận', completed: true },
                    { status: 'verifying', date: '2026-01-10 14:30', note: 'Đang xác minh thông tin', completed: true },
                    { status: 'processing', date: '2026-01-12 10:00', note: 'Đang xử lý', completed: true },
                    { status: 'approval', date: '2026-01-15 11:00', note: 'Đã phê duyệt', completed: true },
                    { status: 'completed', date: '2026-01-16 08:00', note: 'Hoàn thành - Đã trả kết quả', completed: true }
                ]
            },
            'HS2026009012': {
                code: 'HS2026009012',
                serviceName: 'Cấp Giấy phép lái xe hạng B1',
                applicant: 'Lê Thị Hương',
                phone: '0987654321',
                submitDate: '2026-01-18',
                estimatedDate: '2026-02-01',
                status: 'pending',
                fee: '135,000 VNĐ',
                agency: 'Sở Giao thông Vận tải TP. Hồ Chí Minh',
                timeline: [
                    { status: 'received', date: '2026-01-18 10:00', note: 'Hồ sơ đã được tiếp nhận', completed: true },
                    { status: 'verifying', date: '', note: 'Chờ xác minh thông tin', completed: false },
                    { status: 'processing', date: '', note: 'Chờ xử lý', completed: false },
                    { status: 'approval', date: '', note: 'Chờ phê duyệt', completed: false },
                    { status: 'completed', date: '', note: 'Hoàn thành', completed: false }
                ]
            }
        };

        // Toggle mobile menu
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        }

        // Fill demo code
        function fillDemoCode(code) {
            document.getElementById('tracking-code').value = code;
            document.getElementById('tracking-form').dispatchEvent(new Event('submit'));
        }

        // Search another
        function searchAnother() {
            document.getElementById('tracking-code').value = '';
            document.getElementById('result-section').classList.add('hidden');
            document.getElementById('error-state').classList.add('hidden');
            document.getElementById('demo-codes').classList.remove('hidden');
            document.getElementById('tracking-code').focus();
        }

        // Print result
        function printResult() {
            window.print();
        }

        // Get status badge
        function getStatusBadge(status) {
            const statusMap = {
                'pending': { text: 'Chờ xử lý', class: 'bg-warning text-white' },
                'processing': { text: 'Đang xử lý', class: 'bg-accent text-white' },
                'completed': { text: 'Hoàn thành', class: 'bg-success text-white' },
                'rejected': { text: 'Từ chối', class: 'bg-vietred text-white' }
            };
            const info = statusMap[status] || statusMap['pending'];
            return `<span class="px-4 py-2 rounded-lg text-sm font-semibold ${info.class}">${info.text}</span>`;
        }

        // Format date
        function formatDate(dateStr) {
            if (!dateStr) return '---';
            const date = new Date(dateStr);
            return date.toLocaleDateString('vi-VN', { 
                year: 'numeric', 
                month: '2-digit', 
                day: '2-digit' 
            });
        }

        // Display result
        function displayResult(data) {
            document.getElementById('result-code').textContent = data.code;
            document.getElementById('result-status-badge').innerHTML = getStatusBadge(data.status);
            document.getElementById('result-service-name').textContent = data.serviceName;
            document.getElementById('result-applicant').textContent = data.applicant;
            document.getElementById('result-submit-date').textContent = formatDate(data.submitDate);
            document.getElementById('result-estimated').textContent = formatDate(data.estimatedDate);
            document.getElementById('result-agency').textContent = data.agency;
            document.getElementById('result-fee').textContent = data.fee;

            // Timeline
            const timelineEl = document.getElementById('result-timeline');
            timelineEl.innerHTML = data.timeline.map((item, index) => `
                <div class="relative timeline-line pb-8 last:pb-0">
                    <div class="flex items-start gap-4">
                        <div class="w-10 h-10 rounded-full flex items-center justify-center flex-shrink-0 z-10 ${item.completed ? 'bg-accent text-white' : 'bg-warmgray text-muted border-2 border-border'}">
                            ${item.completed ? `
                                <svg class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                                    <polyline points="20,6 9,17 4,12"/>
                                </svg>
                            ` : `
                                <span class="text-sm font-bold">${index + 1}</span>
                            `}
                        </div>
                        <div class="flex-1 pt-1">
                            <p class="font-semibold ${item.completed ? 'text-navy' : 'text-muted'}">${item.note}</p>
                            ${item.date ? `<p class="text-sm text-muted mt-1">${item.date}</p>` : ''}
                        </div>
                    </div>
                </div>
            `).join('');

            document.getElementById('demo-codes').classList.add('hidden');
            document.getElementById('result-section').classList.remove('hidden');
        }

        // Form submission
        document.getElementById('tracking-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const code = document.getElementById('tracking-code').value.trim().toUpperCase();
            
            if (!code) {
                alert('Vui lòng nhập mã hồ sơ');
                return;
            }

            // Show loading
            document.getElementById('loading-state').classList.remove('hidden');
            document.getElementById('result-section').classList.add('hidden');
            document.getElementById('error-state').classList.add('hidden');

            // Simulate API call
            await new Promise(resolve => setTimeout(resolve, 1000));

            document.getElementById('loading-state').classList.add('hidden');

            // Check demo data first
            if (demoData[code]) {
                displayResult(demoData[code]);
                return;
            }

            // Try API
            try {
                const response = await fetch(`${API_BASE}/api/tracking/${code}`);
                const result = await response.json();

                if (result.success && result.data) {
                    displayResult(result.data);
                } else {
                    // Try applications API
                    const appResponse = await fetch(`${API_BASE}/api/applications/${code}`);
                    const appResult = await appResponse.json();

                    if (appResult.success && appResult.data) {
                        const app = appResult.data;
                        displayResult({
                            code: app.code,
                            serviceName: app.serviceName,
                            applicant: app.applicant.fullName,
                            submitDate: app.createdAt.split('T')[0],
                            estimatedDate: app.estimatedCompletion,
                            status: app.status,
                            fee: app.fee || 'Theo quy định',
                            agency: 'Cơ quan hành chính',
                            timeline: app.statusHistory.map((h, i) => ({
                                status: h.status,
                                date: h.date.replace('T', ' ').slice(0, 16),
                                note: h.note,
                                completed: true
                            }))
                        });
                    } else {
                        document.getElementById('error-state').classList.remove('hidden');
                    }
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('error-state').classList.remove('hidden');
            }
        });

        // Check URL params
        const urlParams = new URLSearchParams(window.location.search);
        const codeParam = urlParams.get('code');
        if (codeParam) {
            document.getElementById('tracking-code').value = codeParam;
            document.getElementById('tracking-form').dispatchEvent(new Event('submit'));
        }
    </script>
    <!-- Background Music Player -->
    <script src="/js/music-player.js"></script>
    <!-- Vercel Analytics -->
    <script defer src="/_vercel/insights/script.js"></script>
</body>
</html>
